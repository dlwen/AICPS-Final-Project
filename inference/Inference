{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1SKqVUhxeaNTavzMNcyIY-uw3_1wKWR0a","timestamp":1745271008195}],"gpuType":"T4","machine_shape":"hm","toc_visible":true,"authorship_tag":"ABX9TyMd4SFCD9tyGNpghJ3+unx/"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"5dc9a2190d574432846fc624c2aa1b41":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f61b89b2df894b70a0fd8a5e628a5016","IPY_MODEL_eefe280bc7374822a2598c9500aa9ded","IPY_MODEL_27d3abe227794025a744a1050e2f2e57"],"layout":"IPY_MODEL_e8daf4b748f5467ab873df7101aec7ad"}},"f61b89b2df894b70a0fd8a5e628a5016":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dd12740b58594454a5e90cb898e3ecf4","placeholder":"​","style":"IPY_MODEL_e20289dac9e44459ad5b6032ada45568","value":"tokenizer_config.json: 100%"}},"eefe280bc7374822a2598c9500aa9ded":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5bcfd0d51e8c49d8b02340a82446b9d8","max":26,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2bab52f67c2a451a9c023c9e9e62fcea","value":26}},"27d3abe227794025a744a1050e2f2e57":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_06181e8989204378aa52ddc57dc33ee6","placeholder":"​","style":"IPY_MODEL_42b802cfdd6e485f87977c4c3496bf33","value":" 26.0/26.0 [00:00&lt;00:00, 2.95kB/s]"}},"e8daf4b748f5467ab873df7101aec7ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dd12740b58594454a5e90cb898e3ecf4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e20289dac9e44459ad5b6032ada45568":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5bcfd0d51e8c49d8b02340a82446b9d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2bab52f67c2a451a9c023c9e9e62fcea":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"06181e8989204378aa52ddc57dc33ee6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"42b802cfdd6e485f87977c4c3496bf33":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b8d88001922449adbec817469a6b49a5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3ba67ba316ff4b7d8202104657b492e3","IPY_MODEL_364b52e263ee46a1b2f9a97aafefa44c","IPY_MODEL_25fe58092d0148eebf5db615f700b1e0"],"layout":"IPY_MODEL_68160b7409e94c7e9265bba70ed7a650"}},"3ba67ba316ff4b7d8202104657b492e3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b7d2adc14a1045ad81874e899b62a42d","placeholder":"​","style":"IPY_MODEL_e6c1e7cf59164481bb4f6ab0f39d8181","value":"vocab.json: 100%"}},"364b52e263ee46a1b2f9a97aafefa44c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b017ae23a03b47209cb8e5786cbfca75","max":1042301,"min":0,"orientation":"horizontal","style":"IPY_MODEL_84770d030e3549489225b3116bd97522","value":1042301}},"25fe58092d0148eebf5db615f700b1e0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92ced750cd484af4a837185d8895b626","placeholder":"​","style":"IPY_MODEL_0bce872f581b4c71b8bd60c5890afef8","value":" 1.04M/1.04M [00:00&lt;00:00, 1.63MB/s]"}},"68160b7409e94c7e9265bba70ed7a650":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b7d2adc14a1045ad81874e899b62a42d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6c1e7cf59164481bb4f6ab0f39d8181":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b017ae23a03b47209cb8e5786cbfca75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"84770d030e3549489225b3116bd97522":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"92ced750cd484af4a837185d8895b626":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0bce872f581b4c71b8bd60c5890afef8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fb9a54ac793646e4a95366a4545a8bf8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4415070afdfd4174a1999a09f5f1e282","IPY_MODEL_e511813060ca44f6ae2d6f1df85b8876","IPY_MODEL_c83a0018531d477cb63f655f1cee6c41"],"layout":"IPY_MODEL_ca314892e1984586bffa5df524fffd73"}},"4415070afdfd4174a1999a09f5f1e282":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e8d69f15244c491c825c8e52b3274986","placeholder":"​","style":"IPY_MODEL_e94271da41d442cb95340b395a61a223","value":"merges.txt: 100%"}},"e511813060ca44f6ae2d6f1df85b8876":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_39d83ae5c38a478a8ed66d1a15db18cb","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d7ec4bb1400140b2bda3f02d739998f5","value":456318}},"c83a0018531d477cb63f655f1cee6c41":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_325398cbf996414ba2ecda587befe7eb","placeholder":"​","style":"IPY_MODEL_2585064dceb74801a26e8a9e8f0745b4","value":" 456k/456k [00:00&lt;00:00, 47.7MB/s]"}},"ca314892e1984586bffa5df524fffd73":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e8d69f15244c491c825c8e52b3274986":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e94271da41d442cb95340b395a61a223":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"39d83ae5c38a478a8ed66d1a15db18cb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d7ec4bb1400140b2bda3f02d739998f5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"325398cbf996414ba2ecda587befe7eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2585064dceb74801a26e8a9e8f0745b4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"66b25811bcec486397816416b69adf60":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cd9417b7913d455ebf08fa3f091af626","IPY_MODEL_4fa9820e414c4ea5ae0e92fa1b89cff2","IPY_MODEL_bce8666595bf4caaafe9733318cd41d9"],"layout":"IPY_MODEL_c08983b46cf34d0888f391898b09b2b5"}},"cd9417b7913d455ebf08fa3f091af626":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0a421c511854450e8d060b0ca32a8248","placeholder":"​","style":"IPY_MODEL_3a1d28c7b1fb426f97032337596a5584","value":"tokenizer.json: 100%"}},"4fa9820e414c4ea5ae0e92fa1b89cff2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_903ece77f67f4167b2383b346d5fadf6","max":1355256,"min":0,"orientation":"horizontal","style":"IPY_MODEL_74a70024cfb842fabe429f802cad517e","value":1355256}},"bce8666595bf4caaafe9733318cd41d9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_63b3fdd3f0af4137a58da64f21fa36a7","placeholder":"​","style":"IPY_MODEL_9a0c69cad46048b5b04418bd90fd5f40","value":" 1.36M/1.36M [00:00&lt;00:00, 5.95MB/s]"}},"c08983b46cf34d0888f391898b09b2b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a421c511854450e8d060b0ca32a8248":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a1d28c7b1fb426f97032337596a5584":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"903ece77f67f4167b2383b346d5fadf6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"74a70024cfb842fabe429f802cad517e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"63b3fdd3f0af4137a58da64f21fa36a7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a0c69cad46048b5b04418bd90fd5f40":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"61922a73ea8d4b37891edc9a5be9216f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9fc9ef7cb57c47b9bafd36bc992c7657","IPY_MODEL_79511ed93e654095bfa672ed56f12e56","IPY_MODEL_0b3ccb4c8d1c456bab8188fef6e5f315"],"layout":"IPY_MODEL_e4b2ccf9fdd84fd1b9de3aafd1e7bbf9"}},"9fc9ef7cb57c47b9bafd36bc992c7657":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_75278bb3b3ed4d8cb18486b253638af5","placeholder":"​","style":"IPY_MODEL_9170d81ae2d04657b126d0117e0e3bd8","value":"config.json: 100%"}},"79511ed93e654095bfa672ed56f12e56":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e0d308ccf01b4fdf83946a6760cf1d7d","max":665,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e6bdbf98c0104c87914f2f995c6219b1","value":665}},"0b3ccb4c8d1c456bab8188fef6e5f315":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a0862b49f75c4cd282004553465809e7","placeholder":"​","style":"IPY_MODEL_b04d591141104514a0e9a0ae0c4cea37","value":" 665/665 [00:00&lt;00:00, 72.0kB/s]"}},"e4b2ccf9fdd84fd1b9de3aafd1e7bbf9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"75278bb3b3ed4d8cb18486b253638af5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9170d81ae2d04657b126d0117e0e3bd8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e0d308ccf01b4fdf83946a6760cf1d7d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6bdbf98c0104c87914f2f995c6219b1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a0862b49f75c4cd282004553465809e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b04d591141104514a0e9a0ae0c4cea37":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ab47bac80e594f1eab03b600d4194a5f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e6f39e19e7d54cbe9aa847dd032503c9","IPY_MODEL_aced3d96ccdb4e19a403fb42d406ab04","IPY_MODEL_54b8178dba694a019227db445d861a1b"],"layout":"IPY_MODEL_aeb1e07df01a427ba882f984fd4cdc92"}},"e6f39e19e7d54cbe9aa847dd032503c9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ce7eb6defa7b4a94a3829f064b188d6d","placeholder":"​","style":"IPY_MODEL_9772861e271b4c048755241db97daae5","value":"model.safetensors: 100%"}},"aced3d96ccdb4e19a403fb42d406ab04":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a02fe2ada8284c1498c31a839836e0cd","max":548105171,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bbd503a1a7f444b090d932b12b7f3923","value":548105171}},"54b8178dba694a019227db445d861a1b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_374367d0bd414665ac807e753fa458f4","placeholder":"​","style":"IPY_MODEL_630116480ae84868a89bddc293a737e7","value":" 548M/548M [00:01&lt;00:00, 490MB/s]"}},"aeb1e07df01a427ba882f984fd4cdc92":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ce7eb6defa7b4a94a3829f064b188d6d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9772861e271b4c048755241db97daae5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a02fe2ada8284c1498c31a839836e0cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bbd503a1a7f444b090d932b12b7f3923":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"374367d0bd414665ac807e753fa458f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"630116480ae84868a89bddc293a737e7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"630a1bd759fb43ab93bba9fc63586f44":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_949328e973cf4e318bb40832953e9b2a","IPY_MODEL_a5c8bf49645e4534882e208f2fde5805","IPY_MODEL_20c3aeb0f65440b4be4c49fb41913c96"],"layout":"IPY_MODEL_1899195deda84cd3b4cf697d00d4f4ee"}},"949328e973cf4e318bb40832953e9b2a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_44b5ec3253104d92a0b540608a61167c","placeholder":"​","style":"IPY_MODEL_b96dd8bbdb014d42916724e1527009cc","value":"generation_config.json: 100%"}},"a5c8bf49645e4534882e208f2fde5805":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_544d437b6f2c4a769b1a3c993c57d4a2","max":124,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7fd80e3c4f3648978dcde94de1e2a3c0","value":124}},"20c3aeb0f65440b4be4c49fb41913c96":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_022272f1caa8453d8c8e81e01d32ac65","placeholder":"​","style":"IPY_MODEL_d56fe83ed5384688a45d80a4a8620b3a","value":" 124/124 [00:00&lt;00:00, 15.9kB/s]"}},"1899195deda84cd3b4cf697d00d4f4ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44b5ec3253104d92a0b540608a61167c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b96dd8bbdb014d42916724e1527009cc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"544d437b6f2c4a769b1a3c993c57d4a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7fd80e3c4f3648978dcde94de1e2a3c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"022272f1caa8453d8c8e81e01d32ac65":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d56fe83ed5384688a45d80a4a8620b3a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# **Set Up Environment**"],"metadata":{"id":"0yC0X-3W_av0"}},{"cell_type":"code","source":["!pip install -U openai-whisper\n","!pip install torch torchvision torchaudio pytorch-lightning sentencepiece av"],"metadata":{"id":"BQGGvXCGtW1N","collapsed":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!pip install setuptools-rust"],"metadata":{"id":"wzfAvm3ctcLO","collapsed":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["%cd auto_avsr/preparation\n","!pip install -r requirements.txt"],"metadata":{"id":"PWccySCgWknI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["%cd ../..\n","!git clone https://github.com/hhj1897/face_detection.git\n","%cd face_detection\n","!git lfs pull\n","%pip install -e .\n","%cd .."],"metadata":{"collapsed":true,"id":"erKj1cuZXCpy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import sys\n","import os\n","\n","# Change it to the dictionary of these two folder\n","face_alignment_path = \"face_alignment\"\n","face_detection_path = \"face_detection\"\n","\n","\n","sys.path.insert(0, face_alignment_path)\n","sys.path.insert(0, face_detection_path)\n","\n","try:\n","    from ibug.face_alignment import FANPredictor\n","    print(\"Successfully imported FANPredictor\")\n","    from ibug.face_detection import RetinaFacePredictor\n","    print(\"Successfully imported RetinaFacePredictor\")\n","except ImportError as e:\n","    print(f\"Import Error: {e}\")\n","    print(\"\\nCurrent sys.path:\")\n","    for p in sys.path:\n","        print(p)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"scV8GNXTXJ4k","executionInfo":{"status":"ok","timestamp":1745278421249,"user_tz":300,"elapsed":25743,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"358942ed-6245-43e6-e9c3-7063720cab6e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Successfully imported FANPredictor\n","Successfully imported RetinaFacePredictor\n"]}]},{"cell_type":"code","source":["%cd auto_avsr\n"],"metadata":{"collapsed":true,"id":"WJ-rqYU7YP74"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import sys\n","sys.path.insert(0, \"../\")\n","import os\n","import torch\n","import torchaudio\n","import torchvision\n","import os\n","from lightning import ModelModule\n","from datamodule.transforms import AudioTransform, VideoTransform"],"metadata":{"id":"3Vkv7W-hYUal"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import os\n","import whisper\n","\n","audio_model = whisper.load_model(\"turbo\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3xe84hu2SNd0","executionInfo":{"status":"ok","timestamp":1745278478579,"user_tz":300,"elapsed":27148,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"04c49764-a4c3-4726-f388-b5b6bb83108f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████████████████████████████████| 1.51G/1.51G [00:10<00:00, 150MiB/s]\n"]}]},{"cell_type":"markdown","source":["# **Visual ASR**"],"metadata":{"id":"7tzSpVS2Qq9p"}},{"cell_type":"code","source":["import argparse\n","parser = argparse.ArgumentParser()\n","args, _ = parser.parse_known_args(args=[])"],"metadata":{"id":"tbGXlCA0aQi1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class InferencePipeline(torch.nn.Module):\n","    def __init__(self, args, ckpt_path, detector=\"retinaface\"):\n","        super(InferencePipeline, self).__init__()\n","        self.modality = args.modality\n","        if self.modality == \"audio\":\n","            self.audio_transform = AudioTransform(subset=\"test\")\n","        elif self.modality == \"video\":\n","            if detector == \"mediapipe\":\n","                from preparation.detectors.mediapipe.detector import LandmarksDetector\n","                from preparation.detectors.mediapipe.video_process import VideoProcess\n","                self.landmarks_detector = LandmarksDetector()\n","                self.video_process = VideoProcess(convert_gray=False)\n","            elif detector == \"retinaface\":\n","                from preparation.detectors.retinaface.detector import LandmarksDetector\n","                from preparation.detectors.retinaface.video_process import VideoProcess\n","                self.landmarks_detector = LandmarksDetector(device=\"cuda:0\")\n","                self.video_process = VideoProcess(convert_gray=False)\n","            self.video_transform = VideoTransform(subset=\"test\")\n","\n","        ckpt = torch.load(ckpt_path, map_location=lambda storage, loc: storage)\n","        self.modelmodule = ModelModule(args)\n","        self.modelmodule.model.load_state_dict(ckpt)\n","        self.modelmodule.eval()\n","\n","    def load_video(self, data_filename):\n","        return torchvision.io.read_video(data_filename, pts_unit=\"sec\")[0].numpy()\n","\n","    def forward(self, data_filename):\n","        data_filename = os.path.abspath(data_filename)\n","        assert os.path.isfile(data_filename), f\"data_filename: {data_filename} does not exist.\"\n","\n","        if self.modality == \"audio\":\n","            audio, sample_rate = self.load_audio(data_filename)\n","            audio = self.audio_process(audio, sample_rate)\n","            audio = audio.transpose(1, 0)\n","            audio = self.audio_transform(audio)\n","            with torch.no_grad():\n","                transcript = self.modelmodule(audio)\n","\n","        if self.modality == \"video\":\n","            video = self.load_video(data_filename)\n","            landmarks = self.landmarks_detector(video)\n","            video = self.video_process(video, landmarks)\n","            video = torch.tensor(video)\n","            video = video.permute((0, 3, 1, 2))\n","            video = self.video_transform(video)\n","        #     with torch.no_grad():\n","        #         transcript = self.modelmodule(video)\n","        # return transcript\n","            with torch.no_grad():\n","                predicted, confidence_score, nbest_hyps, best_hype = self.modelmodule(video)\n","            return predicted, confidence_score, nbest_hyps, best_hype\n","\n","    def load_audio(self, data_filename):\n","        waveform, sample_rate = torchaudio.load(data_filename, normalize=True)\n","        return waveform, sample_rate\n","\n","    def load_video(self, data_filename):\n","        return torchvision.io.read_video(data_filename, pts_unit=\"sec\")[0].numpy()\n","\n","    def audio_process(self, waveform, sample_rate, target_sample_rate=16000):\n","        if sample_rate != target_sample_rate:\n","            waveform = torchaudio.functional.resample(\n","                waveform, sample_rate, target_sample_rate\n","            )\n","        waveform = torch.mean(waveform, dim=0, keepdim=True)\n","        return waveform"],"metadata":{"id":"Uu_n7SJSaTmJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model_path = \"../inference/visual_asr.pth\"\n","import os\n","print(\"model_path:\", model_path)\n","print(\"model file exists:\", os.path.exists(model_path))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RBNC5NGEaWSU","executionInfo":{"status":"ok","timestamp":1745278478622,"user_tz":300,"elapsed":18,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"38f961e8-fe00-4623-b323-3c084b5c2e38"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["model_path: ../inference/visual_asr.pth\n","model file exists: True\n"]}]},{"cell_type":"code","source":["setattr(args, 'modality', 'video')\n","pipeline = InferencePipeline(args, model_path, detector=\"retinaface\")"],"metadata":{"id":"TrX42upGbopn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def generate_visualASRTxt(file_name, model):\n","  input_path = \"../inference/data/video/\" + file_name\n","  output_path = \"../inference/data/VSR_result/\" + file_name.split(\".\")[0] + \".txt\"\n","  predicted, confidence_score, nbest_hyps, best_hype = pipeline(input_path)\n","  with open(output_path, 'w') as file:\n","    file.write(predicted)\n","  return predicted, confidence_score"],"metadata":{"id":"tebcFyVVcU44"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# **Audio ASR**"],"metadata":{"id":"9jeIkRPCWKR-"}},{"cell_type":"code","source":["file_name = \"noisy_1.mp4\"\n","\n","def generate_audioASRTxt(file_name, model):\n","  confidence_by_segment = []\n","  input_path = \"../inference/data/video/\" + file_name\n","  output_path = \"../inference/data/ASR_result/\" + file_name.split(\".\")[0] + \".txt\"\n","  result = model.transcribe(input_path)\n","  predicted = result[\"text\"]\n","  with open(output_path, 'w') as file:\n","    file.write(predicted)\n","  confidence_by_segment = []\n","  for segment in result[\"segments\"]:\n","    confidence_by_segment.append(segment[\"avg_logprob\"])\n","  confidence = sum(confidence_by_segment) / len(confidence_by_segment)\n","  return predicted, confidence\n"],"metadata":{"id":"sp0JZjj1QuW1"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# **Fusion**"],"metadata":{"id":"ct198gsvljfz"}},{"cell_type":"code","source":["from transformers import GPT2LMHeadModel, GPT2Tokenizer\n","import torch\n","tokenizer = GPT2Tokenizer.from_pretrained(\"gpt2\")\n","lm_model = GPT2LMHeadModel.from_pretrained(\"gpt2\")\n","lm_model.eval()\n","\n","def get_lm_score(prefix: str, candidate: str) -> float:\n","    text = (prefix + \" \" + candidate).strip()\n","    inputs = tokenizer(text, return_tensors=\"pt\")\n","    with torch.no_grad():\n","        outputs = lm_model(**inputs, labels=inputs[\"input_ids\"])\n","    return -outputs.loss.item()\n","\n","def fuse_transcripts_final(\n","    visual_text: str,\n","    audio_text: str,\n","    visual_conf: float,\n","    audio_conf: float,\n","    alpha_v: float = 1.0,\n","    alpha_a: float = 1.0,\n","    alpha_lm: float = 0.2,\n","    switch_penalty: float = 0.1,\n","    audio_strong_threshold: float = -0.2,\n","    audio_weak_threshold: float = -0.4,\n","    lowercase: bool = True\n",") -> str:\n","    def normalize(text: str) -> str:\n","        t = text.strip()\n","        if lowercase:\n","            t = t.lower()\n","        for ch in \".,?!'\\\"\":\n","            t = t.replace(ch, \"\")\n","        return t\n","\n","    if audio_conf > audio_strong_threshold:\n","        return normalize(audio_text)\n","    if audio_conf < audio_weak_threshold:\n","        return normalize(visual_text)\n","\n","    v_tokens = normalize(visual_text).split()\n","    a_tokens = normalize(audio_text).split()\n","    max_len = max(len(v_tokens), len(a_tokens))\n","    v_tokens += [\"\"] * (max_len - len(v_tokens))\n","    a_tokens += [\"\"] * (max_len - len(a_tokens))\n","\n","    fused = []\n","    prev_source = None\n","\n","    for i in range(max_len):\n","        v_word = v_tokens[i]\n","        a_word = a_tokens[i]\n","\n","        if not a_word:\n","            fused.append(v_word)\n","            prev_source = 'visual'\n","            continue\n","        if not v_word:\n","            fused.append(a_word)\n","            prev_source = 'audio'\n","            continue\n","\n","        v_score = alpha_v * (-visual_conf)\n","        a_score = alpha_a * (-audio_conf)\n","\n","        prefix = \" \".join(fused)\n","        v_lm = get_lm_score(prefix, v_word) if alpha_lm > 0 else 0.0\n","        a_lm = get_lm_score(prefix, a_word) if alpha_lm > 0 else 0.0\n","\n","        v_total = v_score + alpha_lm * v_lm\n","        a_total = a_score + alpha_lm * a_lm\n","\n","        if a_total >= v_total:\n","            chosen = a_word\n","            source = 'audio'\n","            score = a_total\n","        else:\n","            chosen = v_word\n","            source = 'visual'\n","            score = v_total\n","\n","        if prev_source and source != prev_source:\n","            score -= switch_penalty\n","\n","        fused.append(chosen)\n","        prev_source = source\n","\n","    generate_text = \" \".join(fused)\n","\n","    return generate_text\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":297,"referenced_widgets":["5dc9a2190d574432846fc624c2aa1b41","f61b89b2df894b70a0fd8a5e628a5016","eefe280bc7374822a2598c9500aa9ded","27d3abe227794025a744a1050e2f2e57","e8daf4b748f5467ab873df7101aec7ad","dd12740b58594454a5e90cb898e3ecf4","e20289dac9e44459ad5b6032ada45568","5bcfd0d51e8c49d8b02340a82446b9d8","2bab52f67c2a451a9c023c9e9e62fcea","06181e8989204378aa52ddc57dc33ee6","42b802cfdd6e485f87977c4c3496bf33","b8d88001922449adbec817469a6b49a5","3ba67ba316ff4b7d8202104657b492e3","364b52e263ee46a1b2f9a97aafefa44c","25fe58092d0148eebf5db615f700b1e0","68160b7409e94c7e9265bba70ed7a650","b7d2adc14a1045ad81874e899b62a42d","e6c1e7cf59164481bb4f6ab0f39d8181","b017ae23a03b47209cb8e5786cbfca75","84770d030e3549489225b3116bd97522","92ced750cd484af4a837185d8895b626","0bce872f581b4c71b8bd60c5890afef8","fb9a54ac793646e4a95366a4545a8bf8","4415070afdfd4174a1999a09f5f1e282","e511813060ca44f6ae2d6f1df85b8876","c83a0018531d477cb63f655f1cee6c41","ca314892e1984586bffa5df524fffd73","e8d69f15244c491c825c8e52b3274986","e94271da41d442cb95340b395a61a223","39d83ae5c38a478a8ed66d1a15db18cb","d7ec4bb1400140b2bda3f02d739998f5","325398cbf996414ba2ecda587befe7eb","2585064dceb74801a26e8a9e8f0745b4","66b25811bcec486397816416b69adf60","cd9417b7913d455ebf08fa3f091af626","4fa9820e414c4ea5ae0e92fa1b89cff2","bce8666595bf4caaafe9733318cd41d9","c08983b46cf34d0888f391898b09b2b5","0a421c511854450e8d060b0ca32a8248","3a1d28c7b1fb426f97032337596a5584","903ece77f67f4167b2383b346d5fadf6","74a70024cfb842fabe429f802cad517e","63b3fdd3f0af4137a58da64f21fa36a7","9a0c69cad46048b5b04418bd90fd5f40","61922a73ea8d4b37891edc9a5be9216f","9fc9ef7cb57c47b9bafd36bc992c7657","79511ed93e654095bfa672ed56f12e56","0b3ccb4c8d1c456bab8188fef6e5f315","e4b2ccf9fdd84fd1b9de3aafd1e7bbf9","75278bb3b3ed4d8cb18486b253638af5","9170d81ae2d04657b126d0117e0e3bd8","e0d308ccf01b4fdf83946a6760cf1d7d","e6bdbf98c0104c87914f2f995c6219b1","a0862b49f75c4cd282004553465809e7","b04d591141104514a0e9a0ae0c4cea37","ab47bac80e594f1eab03b600d4194a5f","e6f39e19e7d54cbe9aa847dd032503c9","aced3d96ccdb4e19a403fb42d406ab04","54b8178dba694a019227db445d861a1b","aeb1e07df01a427ba882f984fd4cdc92","ce7eb6defa7b4a94a3829f064b188d6d","9772861e271b4c048755241db97daae5","a02fe2ada8284c1498c31a839836e0cd","bbd503a1a7f444b090d932b12b7f3923","374367d0bd414665ac807e753fa458f4","630116480ae84868a89bddc293a737e7","630a1bd759fb43ab93bba9fc63586f44","949328e973cf4e318bb40832953e9b2a","a5c8bf49645e4534882e208f2fde5805","20c3aeb0f65440b4be4c49fb41913c96","1899195deda84cd3b4cf697d00d4f4ee","44b5ec3253104d92a0b540608a61167c","b96dd8bbdb014d42916724e1527009cc","544d437b6f2c4a769b1a3c993c57d4a2","7fd80e3c4f3648978dcde94de1e2a3c0","022272f1caa8453d8c8e81e01d32ac65","d56fe83ed5384688a45d80a4a8620b3a"]},"id":"y-PvZ9Ptlc8j","executionInfo":{"status":"ok","timestamp":1745278541704,"user_tz":300,"elapsed":10391,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"35335f82-c121-4595-fcac-1b9a4fc74db3"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/26.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5dc9a2190d574432846fc624c2aa1b41"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.json:   0%|          | 0.00/1.04M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b8d88001922449adbec817469a6b49a5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fb9a54ac793646e4a95366a4545a8bf8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"66b25811bcec486397816416b69adf60"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/665 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"61922a73ea8d4b37891edc9a5be9216f"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`\n","WARNING:huggingface_hub.file_download:Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`\n"]},{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/548M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ab47bac80e594f1eab03b600d4194a5f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["generation_config.json:   0%|          | 0.00/124 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"630a1bd759fb43ab93bba9fc63586f44"}},"metadata":{}}]},{"cell_type":"markdown","source":["# **Inference**"],"metadata":{"id":"PQNKhV9OeRBq"}},{"cell_type":"code","source":["file_name = \"noisy_1.mp4\""],"metadata":{"id":"eAEpVYDLWOyy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def generate_multimodaltxt(file_name, pipeline):\n","  visual_predicted, visual_confidence_score = generate_visualASRTxt(file_name, pipeline)\n","  audio_result, audio_confidence = generate_audioASRTxt(file_name, audio_model)\n","  fused_text = fuse_transcripts_final(\n","    visual_predicted, audio_result,\n","    visual_confidence_score, audio_confidence)\n","  output_path = \"../inference/data/multimodal_result/\" + file_name.split(\".\")[0] + \".txt\"\n","  with open(output_path, 'w') as file:\n","    file.write(fused_text)\n","  return fused_text\n","\n"],"metadata":{"id":"V5DGOe5togve"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["text = generate_multimodaltxt(file_name, pipeline)"],"metadata":{"id":"SiV9EByapAex"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["text"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":53},"id":"5TklnFEgt_TJ","executionInfo":{"status":"ok","timestamp":1745278730026,"user_tz":300,"elapsed":4,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"7bac0468-685e-4c08-fa43-0d083df27327"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'can i help you i hope so im looking for some material for paper on writing and im not quite sure where to look ill still try to help you what topic is your paper on'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":22}]},{"cell_type":"markdown","source":["# **Generate Transcript for All Files**"],"metadata":{"id":"U2ok72s3f8PG"}},{"cell_type":"code","source":["# This step is just run the inference step above on all videos in the dataset, so it will take quite a long time to finish running\n","folder_path = \"../inference/data/video\"\n","confidence = []\n","for filename in os.listdir(folder_path):\n","    print(\"=============\")\n","    print(filename)\n","    file_name = filename\n","    text = generate_multimodaltxt(file_name, pipeline)\n","    print(text)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pP8q9MKCcI7h","executionInfo":{"status":"ok","timestamp":1745282061325,"user_tz":300,"elapsed":3242136,"user":{"displayName":"lingwen Deng","userId":"09022343709927879672"}},"outputId":"67716016-7a4f-45ab-ef19-2bf37f37037d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["=============\n","quite_1.mp4\n","do you like cooking yes i like cooking very much i got this hobby when i was 12 years old\n","=============\n","quite_2.mp4\n","you look so tan and healthy thanks i just go back from summer camp how was it great i got to try so many things for the first time\n","=============\n","quite_3.mp4\n"]},{"output_type":"stream","name":"stderr","text":["`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.\n"]},{"output_type":"stream","name":"stdout","text":["satya did you get the perfume i give you instant but i tell you the truth i dont want to perfume im sorry i dont know daddy\n","=============\n","quite_4.mp4\n","i would like to register for a class today no problem what class would you like to take i would very much enjoy taking the psychology class because im crazy\n","=============\n","quite_5.mp4\n","hi bill i saw your grandma yesterday oh where was that i was working around the track at my college and she was working around the same track track\n","=============\n","quite_6.mp4\n","granny always tries to stay fit and healthy she is always making us kids the proper food well it pays off for her\n","=============\n","quite_8.mp4\n","to me english is a difficult language a second language is always difficult true but english is harder than the most\n","=============\n","quite_7.mp4\n","to me english is a difficult language a second language is always difficult true but english is harder than the most\n","=============\n","quite_9.mp4\n","do you like traveling yes i like traveling for pleasure to get places for vacation for instance but i dont like traveling to work\n","=============\n","quite_10.mp4\n","what do you like to do in your spare time i like picking taste do you have any hobbies besides picking taste im afraid not\n","=============\n","noisy_1.mp4\n","can i help you i hope so im looking for some material for paper on writing and im not quite sure where to look ill still try to help you what topic is your paper on\n","=============\n","noisy_2.mp4\n","how may i help you i will let you read your number is it all you need i also want to check out this video\n","=============\n","noisy_3.mp4\n","i feel like going for the toilet its been a long day when i hear i hear youre in the toilet how about the room bar rotting around thats it\n","=============\n","noisy_4.mp4\n","he is flipping every recording of your ancestors sure my mom has been working on our family tour for years she is always updating it\n","=============\n","noisy_5.mp4\n","i usually ride my bike which for movie transport you prefer to use\n","=============\n","noisy_6.mp4\n","are you studying courses yes i am going to study some university courses here i want to learn a lot yes i heard\n","=============\n","noisy_7.mp4\n","do you think that you will get backwards you can get done in 60 did that a lot well\n","=============\n","noisy_8.mp4\n","where are we often first we are going to consider the scope for something to drink then we are visiting university museum\n","=============\n","noisy_9.mp4\n","where we going to have a tree sits over the top and runs corner can you see some big building at the end of the road\n","=============\n","noisy_10.mp4\n","how about cinema tonight <unk> im not sure about the name of a film but i know its a romantic one\n","=============\n","midnoise_1.mp4\n","what do you do every time well i like playing the violin really how long have you been playing the violin\n","=============\n","midnoise_2.mp4\n","what sports do you like to play i like basketball and baseball how about football in my country football is brand new\n","=============\n","midnoise_3.mp4\n","are you going to a party on saturday i was thinking about it i heard it is going to be a lot of fun\n","=============\n","midnoise_4.mp4\n","could you talk to me for a few minutes about my grades step into my office for a moment what is your concern am i failing\n","=============\n","midnoise_5.mp4\n","today more and more people have gained life and learning but people have different videos about life and learning how do you understand life and learning i see life and learning as a concept that it is tougher to do in order to get for learning\n","=============\n","midnoise_6.mp4\n","do you have a korean yes i did but i feel tired today i cleaned the house and plugged it in said on sunday i cleaned the country i hiked in the country\n","=============\n","midnoise_7.mp4\n","what is the life expectancy in oklahoma i am not sure but probably about 75 years how about in oklahoma new country\n","=============\n","midnoise_8.mp4\n","how this orchid is it its fine its something growing up of orchids nowadays it will be easier before you go with it\n","=============\n","midnoise_9.mp4\n","teenagers do not want to live traditional lives they want to get out have fun and explore the world they want to develop their own life parents usually try to discourage them but they do not often succeed\n","=============\n","midnoise_10.mp4\n","you have been with you for nearly a month how do you feel about the job not bad thank you for your help i am always busy with this job i feel a little bit tired\n"]}]}]}